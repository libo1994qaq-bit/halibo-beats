<!doctype html>
<html>
  <head prefix="og:http://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta http-equiv="cleartype" content="on" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000000" />
    
    <!-- iOS å…¨å±è®¾ç½® -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="HALIBO Beats" />
    
    <!-- ä¸­æ–‡æè¿° -->
    <meta name="description" content="åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨è§¦æ‘¸å±æˆ–é”®ç›˜æ¸¸ç©çš„éŸ³ä¹èŠ‚å¥æ¸¸æˆã€ŒHALIBO Beatsã€ã€‚" />

    <link rel="icon" href="./favicon.svg" type="image/svg+xml" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="apple-touch-icon" href="./icon-256.png" />

    <!-- ç½‘ç«™ä¿¡æ¯ -->
    <meta property="og:url" content="https://libo1994qaq-bit.github.io/halibo-beats/" />
    <meta property="og:title" content="HALIBO Beats" />
    <meta property="og:description" content="åœ¨æµè§ˆå™¨ä¸­ä½¿ç”¨è§¦æ‘¸å±æˆ–é”®ç›˜æ¸¸ç©çš„éŸ³ä¹èŠ‚å¥æ¸¸æˆã€ŒHALIBO Beatsã€ã€‚" />
    <meta property="og:image" content="https://libo1994qaq-bit.github.io/halibo-beats/ogp.png" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="HALIBO Beats" />
    <meta name="twitter:card" content="summary_large_image" />

    <title>HALIBO Beats - éŸ³ä¹èŠ‚å¥æ¸¸æˆ</title>
    
    <style>
      /* åŸºç¡€æ ·å¼ */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
      }

      html, body {
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #000;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Microsoft YaHei', sans-serif;
        color: #fff;
      }

      /* å¼•å¯¼é¡µé¢ - é»˜è®¤æ˜¾ç¤º */
      #guide-screen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 1000;
        padding: 20px;
        text-align: center;
      }

      .guide-content {
        max-width: 500px;
        width: 100%;
        padding: 30px;
        background: rgba(0, 0, 0, 0.7);
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
        border: 1px solid rgba(255, 255, 255, 0.1);
      }

      .game-logo {
        font-size: 48px;
        font-weight: bold;
        margin-bottom: 10px;
        background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .game-subtitle {
        font-size: 18px;
        margin-bottom: 30px;
        color: #aaa;
      }

      .game-features {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-bottom: 30px;
        flex-wrap: wrap;
      }

      .feature {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 15px;
        background: rgba(255, 255, 255, 0.1);
        border-radius: 10px;
        min-width: 100px;
      }

      .feature-icon {
        font-size: 30px;
        margin-bottom: 10px;
      }

      .feature-text {
        font-size: 14px;
        color: #ccc;
      }

      .guide-instructions {
        background: rgba(255, 255, 255, 0.05);
        padding: 20px;
        border-radius: 10px;
        margin-bottom: 30px;
        text-align: left;
      }

      .instructions-title {
        font-size: 16px;
        margin-bottom: 10px;
        color: #4ecdc4;
      }

      .instructions-list {
        list-style-type: none;
        font-size: 14px;
        line-height: 1.6;
      }

      .instructions-list li {
        margin-bottom: 8px;
        padding-left: 20px;
        position: relative;
      }

      .instructions-list li:before {
        content: "â€¢";
        color: #ff6b6b;
        position: absolute;
        left: 0;
      }

      .guide-buttons {
        display: flex;
        flex-direction: column;
        gap: 15px;
      }

      .primary-button {
        padding: 16px 24px;
        font-size: 18px;
        font-weight: bold;
        background: linear-gradient(45deg, #ff6b6b, #ff8e53);
        color: white;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(255, 107, 107, 0.3);
      }

      .primary-button:hover, .primary-button:active {
        transform: translateY(-3px);
        box-shadow: 0 8px 20px rgba(255, 107, 107, 0.4);
      }

      .secondary-button {
        padding: 12px 20px;
        font-size: 16px;
        background: transparent;
        color: #4ecdc4;
        border: 2px solid #4ecdc4;
        border-radius: 50px;
        cursor: pointer;
        transition: all 0.3s ease;
      }

      .secondary-button:hover, .secondary-button:active {
        background: rgba(78, 205, 196, 0.1);
      }

      /* æ¨ªå±æç¤º */
      #landscape-warning {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        text-align: center;
        padding: 20px;
      }

      .landscape-icon {
        font-size: 80px;
        margin-bottom: 20px;
        animation: rotate 3s infinite linear;
      }

      @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .landscape-text {
        font-size: 20px;
        margin-bottom: 10px;
        color: #ff6b6b;
      }

      .landscape-subtext {
        font-size: 16px;
        margin-bottom: 30px;
        color: #ccc;
        max-width: 300px;
      }

      /* æ¸¸æˆå®¹å™¨ - é»˜è®¤éšè— */
      #game-container {
        display: none;
        width: 100%;
        height: 100%;
        position: relative;
      }

      #game-app {
        width: 100%;
        height: 100%;
        background: #000;
      }

      /* å…¨å±æŒ‰é’® */
      #fullscreen-button {
        position: fixed;
        top: 20px;
        right: 20px;
        z-index: 100;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: 2px solid #4ecdc4;
        padding: 10px 15px;
        border-radius: 25px;
        font-size: 14px;
        cursor: pointer;
        display: none;
        backdrop-filter: blur(5px);
        transition: all 0.3s ease;
      }

      #fullscreen-button:hover {
        background: rgba(78, 205, 196, 0.3);
        transform: scale(1.05);
      }

      /* æ¨ªå±æ¨¡å¼ä¸‹çš„æ ·å¼è°ƒæ•´ */
      @media (orientation: landscape) {
        #landscape-warning {
          display: none !important;
        }
        
        #fullscreen-button {
          display: block;
        }
        
        .guide-content {
          max-width: 700px;
        }
        
        .game-features {
          justify-content: space-around;
        }
      }

      /* ç«–å±æ¨¡å¼ä¸‹çš„ç‰¹æ®Šå¤„ç† */
      @media (orientation: portrait) {
        #landscape-warning {
          display: flex;
        }
        
        .game-features {
          flex-direction: column;
          align-items: center;
        }
        
        .feature {
          width: 80%;
          margin-bottom: 10px;
        }
      }

      /* å°å±å¹•é€‚é… */
      @media (max-width: 480px) {
        .guide-content {
          padding: 20px;
        }
        
        .game-logo {
          font-size: 36px;
        }
        
        .game-subtitle {
          font-size: 16px;
        }
        
        .feature {
          padding: 10px;
        }
        
        .primary-button {
          padding: 14px 20px;
          font-size: 16px;
        }
        
        .secondary-button {
          padding: 10px 16px;
          font-size: 14px;
        }
      }

      /* å¾®ä¿¡æµè§ˆå™¨æç¤º */
      #wechat-warning {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.95);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 3000;
        text-align: center;
        padding: 20px;
      }

      .wechat-icon {
        font-size: 60px;
        margin-bottom: 20px;
      }

      .wechat-text {
        font-size: 20px;
        margin-bottom: 10px;
        color: #07C160; /* å¾®ä¿¡ç»¿è‰² */
      }

      .wechat-instructions {
        background: rgba(7, 193, 96, 0.1);
        padding: 20px;
        border-radius: 10px;
        margin: 20px 0;
        text-align: left;
        max-width: 400px;
      }

      .wechat-instructions ol {
        padding-left: 20px;
        margin-top: 10px;
      }

      .wechat-instructions li {
        margin-bottom: 10px;
        font-size: 14px;
      }

      /* éšè—æ»šåŠ¨æ¡ */
      ::-webkit-scrollbar {
        display: none;
      }
    </style>
    
    <script>
      // åœ¨å¤´éƒ¨æ·»åŠ ä¸€äº›ç«‹å³æ‰§è¡Œçš„æ£€æµ‹ä»£ç 
      (function() {
        // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­
        function isWechatBrowser() {
          const ua = navigator.userAgent.toLowerCase();
          return ua.indexOf('micromessenger') !== -1;
        }
        
        // å¦‚æœæ˜¯å¾®ä¿¡æµè§ˆå™¨ï¼Œè®¾ç½®ä¸€ä¸ªå…¨å±€å˜é‡ä¾›åç»­ä½¿ç”¨
        if (isWechatBrowser()) {
          window.isWechat = true;
        }
      })();
    </script>
  </head>

  <body>
    <!-- å¼•å¯¼å±å¹• -->
    <div id="guide-screen">
      <div class="guide-content">
        <div class="game-logo">HALIBO Beats</div>
        <div class="game-subtitle">éŸ³ä¹èŠ‚å¥æ¸¸æˆ</div>
        
        <div class="game-features">
          <div class="feature">
            <div class="feature-icon">ğŸµ</div>
            <div class="feature-text">ä¸°å¯Œæ›²ç›®</div>
          </div>
          <div class="feature">
            <div class="feature-icon">ğŸ®</div>
            <div class="feature-text">ç®€å•æ“ä½œ</div>
          </div>
          <div class="feature">
            <div class="feature-icon">ğŸ“±</div>
            <div class="feature-text">ç§»åŠ¨ç«¯é€‚é…</div>
          </div>
        </div>
        
        <div class="guide-instructions">
          <div class="instructions-title">æ¸¸æˆè¯´æ˜ï¼š</div>
          <ul class="instructions-list">
            <li>ä½¿ç”¨é”®ç›˜æˆ–è§¦æ‘¸å±è¿›è¡Œæ¸¸æˆ</li>
            <li>å‡†ç¡®ç‚¹å‡»ä¸‹è½çš„éŸ³ç¬¦è·å¾—é«˜åˆ†</li>
            <li>æ¨ªå±æ¨¡å¼å¯è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒ</li>
            <li>æ”¯æŒå…¨å±æ¨¡å¼ï¼Œæ²‰æµ¸å¼æ¸¸ç©</li>
          </ul>
        </div>
        
        <div class="guide-buttons">
          <button id="start-button" class="primary-button">
            ğŸ® å¼€å§‹æ¸¸æˆ
          </button>
          <button id="how-to-play-button" class="secondary-button">
            ğŸ“– å¦‚ä½•è·å¾—æœ€ä½³ä½“éªŒï¼Ÿ
          </button>
        </div>
      </div>
    </div>
    
    <!-- æ¨ªå±æç¤º -->
    <div id="landscape-warning">
      <div class="landscape-icon">ğŸ”„</div>
      <div class="landscape-text">è¯·å°†è®¾å¤‡æ—‹è½¬è‡³æ¨ªå±</div>
      <div class="landscape-subtext">æ¨ªå±æ¨¡å¼å¯è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒï¼ŒéŸ³ç¬¦åˆ¤å®šæ›´å‡†ç¡®</div>
      <button id="continue-portrait-button" class="primary-button">
        ç»§ç»­ç«–å±æ¸¸æˆ
      </button>
    </div>
    
    <!-- å¾®ä¿¡æµè§ˆå™¨æç¤º -->
    <div id="wechat-warning">
      <div class="wechat-icon">ğŸ’¬</div>
      <div class="wechat-text">å¾®ä¿¡æµè§ˆå™¨é™åˆ¶æç¤º</div>
      <div class="wechat-instructions">
        <p>æ£€æµ‹åˆ°æ‚¨æ­£åœ¨ä½¿ç”¨å¾®ä¿¡å†…ç½®æµè§ˆå™¨ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™ï¼š</p>
        <ol>
          <li>å¾®ä¿¡æµè§ˆå™¨å¯èƒ½æ— æ³•å…¨å±æ˜¾ç¤º</li>
          <li>éŸ³é¢‘æ’­æ”¾å¯èƒ½éœ€è¦ç”¨æˆ·äº¤äº’</li>
          <li>å»ºè®®ç‚¹å‡»å³ä¸Šè§’ "..." æŒ‰é’®</li>
          <li>é€‰æ‹© "åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€" ä»¥è·å¾—å®Œæ•´åŠŸèƒ½</li>
        </ol>
      </div>
      <button id="continue-wechat-button" class="primary-button">
        çŸ¥é“äº†ï¼Œç»§ç»­æ¸¸æˆ
      </button>
    </div>
    
    <!-- æ¸¸æˆå®¹å™¨ -->
    <div id="game-container">
      <button id="fullscreen-button">â›¶ å…¨å±æ¨¡å¼</button>
      <div id="game-app"></div>
    </div>

    <script src="./bundle.js"></script>
    
    <script>
      // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
      document.addEventListener('DOMContentLoaded', function() {
        // è·å–DOMå…ƒç´ 
        const guideScreen = document.getElementById('guide-screen');
        const landscapeWarning = document.getElementById('landscape-warning');
        const wechatWarning = document.getElementById('wechat-warning');
        const gameContainer = document.getElementById('game-container');
        const startButton = document.getElementById('start-button');
        const howToPlayButton = document.getElementById('how-to-play-button');
        const continuePortraitButton = document.getElementById('continue-portrait-button');
        const continueWechatButton = document.getElementById('continue-wechat-button');
        const fullscreenButton = document.getElementById('fullscreen-button');
        const gameApp = document.getElementById('game-app');
        
        // æ£€æµ‹æ˜¯å¦æ¨ªå±
        function isLandscape() {
          return window.innerWidth > window.innerHeight;
        }
        
        // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­
        function isWechatBrowser() {
          const ua = navigator.userAgent.toLowerCase();
          return ua.indexOf('micromessenger') !== -1;
        }
        
        // æ£€æŸ¥æ¨ªå±çŠ¶æ€å¹¶æ›´æ–°UI
        function checkOrientation() {
          if (isLandscape()) {
            // æ¨ªå±æ¨¡å¼
            landscapeWarning.style.display = 'none';
            if (gameContainer.style.display === 'block') {
              fullscreenButton.style.display = 'block';
            }
          } else {
            // ç«–å±æ¨¡å¼
            if (gameContainer.style.display === 'block') {
              landscapeWarning.style.display = 'flex';
              fullscreenButton.style.display = 'none';
            }
          }
        }
        
        // å…¨å±åŠŸèƒ½
        function toggleFullscreen() {
          if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
            // è¿›å…¥å…¨å±
            const element = document.documentElement;
            if (element.requestFullscreen) {
              element.requestFullscreen().catch(err => {
                console.log('å…¨å±è¯·æ±‚å¤±è´¥:', err);
                alert('æ— æ³•è¿›å…¥å…¨å±æ¨¡å¼ï¼Œè¯·æ£€æŸ¥æµè§ˆå™¨è®¾ç½®æˆ–å°è¯•æ‰‹åŠ¨å…¨å±ã€‚');
              });
            } else if (element.webkitRequestFullscreen) {
              element.webkitRequestFullscreen();
            } else if (element.msRequestFullscreen) {
              element.msRequestFullscreen();
            }
            
            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            fullscreenButton.innerHTML = 'â›¶ é€€å‡ºå…¨å±';
          } else {
            // é€€å‡ºå…¨å±
            if (document.exitFullscreen) {
              document.exitFullscreen();
            } else if (document.webkitExitFullscreen) {
              document.webkitExitFullscreen();
            } else if (document.msExitFullscreen) {
              document.msExitFullscreen();
            }
            
            // æ›´æ–°æŒ‰é’®æ–‡æœ¬
            fullscreenButton.innerHTML = 'â›¶ å…¨å±æ¨¡å¼';
          }
        }
        
        // å¼€å§‹æ¸¸æˆ
        function startGame() {
          // éšè—å¼•å¯¼å±å¹•
          guideScreen.style.display = 'none';
          
          // æ£€æŸ¥æ˜¯å¦å¾®ä¿¡æµè§ˆå™¨
          if (isWechatBrowser()) {
            wechatWarning.style.display = 'flex';
            return;
          }
          
          // æ˜¾ç¤ºæ¸¸æˆå®¹å™¨
          gameContainer.style.display = 'block';
          
          // æ£€æŸ¥æ¨ªå±çŠ¶æ€
          checkOrientation();
          
          // æ³¨å†ŒService Workerï¼ˆåœ¨ç”¨æˆ·äº¤äº’åï¼‰
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
              .then(registration => {
                console.log('Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope);
              })
              .catch(error => {
                console.log('Service Worker æ³¨å†Œå¤±è´¥:', error);
              });
          }
          
          // é€šçŸ¥æ¸¸æˆå¼€å§‹ï¼ˆå¦‚æœbundle.jséœ€è¦ï¼‰
          if (window.gameStartCallback) {
            window.gameStartCallback();
          }
        }
        
        // äº‹ä»¶ç›‘å¬
        startButton.addEventListener('click', startGame);
        
        howToPlayButton.addEventListener('click', function() {
          alert('å¦‚ä½•è·å¾—æœ€ä½³ä½“éªŒï¼š\n\n1. å°†è®¾å¤‡æ¨ªå±æ”¾ç½®ï¼ˆæ¨èï¼‰\n2. ç‚¹å‡»å³ä¸Šè§’"å…¨å±æ¨¡å¼"æŒ‰é’®\n3. ä½¿ç”¨è€³æœºå¯è·å¾—æ›´å¥½éŸ³æ•ˆ\n4. åœ¨ç³»ç»Ÿæµè§ˆå™¨ä¸­æ‰“å¼€å¯é¿å…å¾®ä¿¡é™åˆ¶\n\nç¥æ‚¨æ¸¸æˆæ„‰å¿«ï¼');
        });
        
        continuePortraitButton.addEventListener('click', function() {
          landscapeWarning.style.display = 'none';
          fullscreenButton.style.display = 'none';
        });
        
        continueWechatButton.addEventListener('click', function() {
          wechatWarning.style.display = 'none';
          gameContainer.style.display = 'block';
          checkOrientation();
          
          // å¾®ä¿¡ä¸­ä¹Ÿéœ€è¦æ³¨å†ŒService Worker
          if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('./service-worker.js')
              .then(registration => {
                console.log('Service Worker æ³¨å†ŒæˆåŠŸ:', registration.scope);
              })
              .catch(error => {
                console.log('Service Worker æ³¨å†Œå¤±è´¥:', error);
              });
          }
        });
        
        fullscreenButton.addEventListener('click', toggleFullscreen);
        
        // ç›‘å¬å…¨å±çŠ¶æ€å˜åŒ–
        document.addEventListener('fullscreenchange', function() {
          if (document.fullscreenElement || document.webkitFullscreenElement || document.msFullscreenElement) {
            fullscreenButton.innerHTML = 'â›¶ é€€å‡ºå…¨å±';
          } else {
            fullscreenButton.innerHTML = 'â›¶ å…¨å±æ¨¡å¼';
          }
        });
        
        // ç›‘å¬æ¨ªç«–å±å˜åŒ–
        window.addEventListener('resize', checkOrientation);
        window.addEventListener('orientationchange', function() {
          // å»¶è¿Ÿä¸€ç‚¹æ—¶é—´æ£€æŸ¥ï¼Œç¡®ä¿æ–¹å‘å·²ç»æ”¹å˜
          setTimeout(checkOrientation, 100);
        });
        
        // é˜²æ­¢è§¦æ‘¸é»˜è®¤è¡Œä¸ºï¼ˆé¿å…ç¼©æ”¾ï¼‰
        document.addEventListener('touchstart', function(e) {
          if (e.touches.length > 1) {
            e.preventDefault();
          }
        }, { passive: false });
        
        document.addEventListener('gesturestart', function(e) {
          e.preventDefault();
        });
        
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
          const now = Date.now();
          if (now - lastTouchEnd <= 300) {
            e.preventDefault();
          }
          lastTouchEnd = now;
        }, false);
        
        // åˆå§‹æ£€æŸ¥
        checkOrientation();
        
        // å¦‚æœå·²ç»æ˜¯æ¨ªå±ï¼Œæ˜¾ç¤ºå…¨å±æŒ‰é’®
        if (isLandscape() && gameContainer.style.display === 'block') {
          fullscreenButton.style.display = 'block';
        }
        
        // å¦‚æœæ˜¯å¾®ä¿¡æµè§ˆå™¨ï¼Œå…¨å±€æç¤º
        if (isWechatBrowser()) {
          console.log('æ£€æµ‹åˆ°å¾®ä¿¡æµè§ˆå™¨ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½å—é™');
        }
        
        // æä¾›å…¨å±€å‡½æ•°ä¾›bundle.jsè°ƒç”¨ï¼ˆå¦‚æœéœ€è¦ï¼‰
        window.showGameGuide = function() {
          guideScreen.style.display = 'flex';
          gameContainer.style.display = 'none';
        };
      });
    </script>
  </body>
</html>