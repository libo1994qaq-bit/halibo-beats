<!doctype html>
<html>
  <head prefix="og:http://ogp.me/ns#">
    <meta charset="utf-8" />
    <!-- å…³é”®ä¿®å¤ï¼šä½¿ç”¨æ­£ç¡®çš„viewportè®¾ç½® -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" />
    <meta name="HandheldFriendly" content="True" />
    <meta name="MobileOptimized" content="320" />
    <meta http-equiv="cleartype" content="on" />
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000000" />
    
    <!-- iOS å…¨å±è®¾ç½® -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="HALIBO Beats" />
    
    <!-- ä¸­æ–‡æè¿° -->
    <meta name="description" content="æ•²å‡»èŠ‚å¥ï¼ŒæŒ‘æˆ˜æé™ï¼HALIBO Beats - æ²‰æµ¸å¼éŸ³ä¹èŠ‚å¥æ¸¸æˆã€‚" />

    <link rel="icon" href="./favicon.svg" type="image/svg+xml" />
    <link rel="manifest" href="./manifest.json" />
    <link rel="apple-touch-icon" href="./icon-256.png" />

    <!-- ç½‘ç«™ä¿¡æ¯ -->
    <meta property="og:url" content="https://libo1994qaq-bit.github.io/halibo-beats/" />
    <meta property="og:title" content="HALIBO Beats" />
    <meta property="og:description" content="æ•²å‡»èŠ‚å¥ï¼ŒæŒ‘æˆ˜æé™ï¼HALIBO Beats - æ²‰æµ¸å¼éŸ³ä¹èŠ‚å¥æ¸¸æˆã€‚" />
    <meta property="og:image" content="https://libo1994qaq-bit.github.io/halibo-beats/ogp.png" />
    <meta property="og:type" content="website" />
    <meta property="og:site_name" content="HALIBO Beats" />
    <meta name="twitter:card" content="summary_large_image" />

    <title>HALIBO Beats</title>
    
    <style>
      /* åŸºç¡€æ ·å¼ - å…³é”®ä¿®å¤ï¼šç¡®ä¿100%å¡«å…… */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        -webkit-tap-highlight-color: transparent;
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Display', 'SF Pro Text', 'Helvetica Neue', Arial, sans-serif;
      }

      html, body {
        width: 100%;
        height: 100%;
        overflow: hidden;
        background-color: #000;
        color: #fff;
        /* å…³é”®ï¼šç¡®ä¿å…¨å±æ—¶æ²¡æœ‰ç©ºç™½ */
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
      }

      /* iOSé£æ ¼æ¯›ç»ç’ƒèƒŒæ™¯ */
      #wechat-warning {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, 
          rgba(0, 0, 0, 0.95) 0%,
          rgba(20, 20, 40, 0.98) 50%,
          rgba(40, 20, 60, 0.95) 100%);
        backdrop-filter: blur(30px);
        -webkit-backdrop-filter: blur(30px);
        display: none;
        flex-direction: column;
        justify-content: space-between;
        align-items: center;
        z-index: 3000;
        padding: 40px 24px;
        overflow: hidden;
      }

      /* é¡¶éƒ¨è£…é¥°å…ƒç´  */
      .top-decoration {
        position: absolute;
        top: 0;
        width: 100%;
        height: 120px;
        overflow: hidden;
        opacity: 0.6;
      }

      .dynamic-line {
        position: absolute;
        top: 20px;
        left: -100%;
        width: 200%;
        height: 2px;
        background: linear-gradient(90deg, transparent, #ff0080, #00ccff, #ff0080, transparent);
        animation: slideLine 8s linear infinite;
      }

      @keyframes slideLine {
        0% { transform: translateX(0); }
        100% { transform: translateX(50%); }
      }

      .floating-dots {
        position: absolute;
        top: 60px;
        width: 100%;
        display: flex;
        justify-content: space-around;
      }

      .dot {
        width: 6px;
        height: 6px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.2);
        animation: float 4s ease-in-out infinite;
      }

      @keyframes float {
        0%, 100% { transform: translateY(0); opacity: 0.2; }
        50% { transform: translateY(-10px); opacity: 0.6; }
      }

      /* å†…å®¹å®¹å™¨ */
      .content-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        width: 100%;
        max-width: 360px;
        margin-top: 40px;
      }

      /* æ¸¸æˆæ ‡é¢˜ */
      .game-title {
        font-size: 42px;
        font-weight: 800;
        background: linear-gradient(45deg, #ff0080, #00ccff, #ff0080);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 20px;
        text-align: center;
        letter-spacing: -0.5px;
        text-shadow: 0 0 30px rgba(255, 0, 128, 0.3);
        animation: titleGlow 3s ease-in-out infinite;
      }

      @keyframes titleGlow {
        0%, 100% { text-shadow: 0 0 30px rgba(255, 0, 128, 0.3); }
        50% { text-shadow: 0 0 50px rgba(255, 0, 128, 0.5), 0 0 70px rgba(0, 204, 255, 0.3); }
      }

      .game-subtitle {
        font-size: 16px;
        color: rgba(255, 255, 255, 0.7);
        margin-bottom: 40px;
        text-align: center;
        font-weight: 300;
        letter-spacing: 2px;
        text-transform: uppercase;
      }

      /* è­¦å‘Šå¡ç‰‡ */
      .warning-card {
        background: rgba(255, 255, 255, 0.05);
        border-radius: 24px;
        padding: 24px;
        width: 100%;
        margin-bottom: 30px;
        border: 1px solid rgba(255, 255, 255, 0.1);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        position: relative;
        overflow: hidden;
      }

      .warning-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #ff0080, #00ccff);
      }

      .warning-title {
        display: flex;
        align-items: center;
        gap: 12px;
        font-size: 20px;
        font-weight: 600;
        color: #ff5555;
        margin-bottom: 16px;
      }

      .warning-icon {
        font-size: 24px;
        animation: pulseWarning 2s ease-in-out infinite;
      }

      @keyframes pulseWarning {
        0%, 100% { transform: scale(1); opacity: 1; }
        50% { transform: scale(1.1); opacity: 0.8; }
      }

      .warning-message {
        font-size: 16px;
        color: rgba(255, 255, 255, 0.8);
        line-height: 1.6;
        font-weight: 300;
      }

      /* æ­¥éª¤å¼•å¯¼ */
      .steps-container {
        background: rgba(255, 255, 255, 0.03);
        border-radius: 24px;
        padding: 32px 24px;
        width: 100%;
        margin-bottom: 40px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        position: relative;
        overflow: hidden;
      }

      .steps-container::after {
        content: '';
        position: absolute;
        top: -50%;
        left: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle at center, rgba(255, 0, 128, 0.1) 0%, transparent 70%);
        animation: rotate 20s linear infinite;
      }

      @keyframes rotate {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }

      .steps-title {
        font-size: 20px;
        font-weight: 600;
        color: #00ccff;
        margin-bottom: 28px;
        text-align: center;
        position: relative;
        z-index: 1;
      }

      .step-item {
        display: flex;
        align-items: center;
        gap: 20px;
        margin-bottom: 24px;
        position: relative;
        z-index: 1;
        transition: transform 0.3s ease;
      }

      .step-item:hover {
        transform: translateX(5px);
      }

      .step-number {
        width: 44px;
        height: 44px;
        background: linear-gradient(135deg, #ff0080, #00ccff);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        font-weight: 700;
        color: white;
        flex-shrink: 0;
        box-shadow: 0 4px 15px rgba(255, 0, 128, 0.3);
        position: relative;
      }

      .step-number::after {
        content: '';
        position: absolute;
        top: -2px;
        left: -2px;
        right: -2px;
        bottom: -2px;
        background: linear-gradient(135deg, #ff0080, #00ccff);
        border-radius: 50%;
        z-index: -1;
        opacity: 0.5;
        animation: pulseNumber 2s ease-in-out infinite;
      }

      @keyframes pulseNumber {
        0%, 100% { transform: scale(1); opacity: 0.5; }
        50% { transform: scale(1.1); opacity: 0.3; }
      }

      .step-text {
        flex: 1;
        font-size: 16px;
        color: rgba(255, 255, 255, 0.9);
        line-height: 1.5;
      }

      .step-highlight {
        color: #00ccff;
        font-weight: 600;
        background: rgba(0, 204, 255, 0.1);
        padding: 2px 8px;
        border-radius: 6px;
        display: inline-block;
      }

      /* æŒ‰é’®åŒºåŸŸ */
      .button-container {
        width: 100%;
        max-width: 360px;
        margin-bottom: 20px;
      }

      .warning-button {
        width: 100%;
        padding: 20px;
        background: rgba(255, 85, 85, 0.1);
        border: 2px solid rgba(255, 85, 85, 0.3);
        border-radius: 20px;
        color: #ff5555;
        font-size: 18px;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 12px;
        position: relative;
        overflow: hidden;
      }

      .warning-button:hover {
        background: rgba(255, 85, 85, 0.2);
        border-color: rgba(255, 85, 85, 0.5);
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(255, 85, 85, 0.2);
      }

      .warning-button:active {
        transform: translateY(0);
      }

      .warning-button::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
        transition: left 0.5s ease;
      }

      .warning-button:hover::before {
        left: 100%;
      }

      .button-icon {
        font-size: 24px;
        animation: shake 3s ease-in-out infinite;
      }

      @keyframes shake {
        0%, 100% { transform: rotate(0deg); }
        25% { transform: rotate(-5deg); }
        75% { transform: rotate(5deg); }
      }

      /* åŠ¨æ€èƒŒæ™¯å…ƒç´  */
      .background-elements {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: -1;
      }

      .element {
        position: absolute;
        border-radius: 50%;
        background: radial-gradient(circle at center, rgba(255, 0, 128, 0.1), transparent);
        animation: floatElement 20s linear infinite;
      }

      .element:nth-child(1) {
        width: 200px;
        height: 200px;
        top: 10%;
        left: 10%;
        animation-delay: 0s;
      }

      .element:nth-child(2) {
        width: 150px;
        height: 150px;
        top: 60%;
        right: 10%;
        animation-delay: -5s;
      }

      .element:nth-child(3) {
        width: 250px;
        height: 250px;
        bottom: 10%;
        left: 20%;
        animation-delay: -10s;
      }

      @keyframes floatElement {
        0% { transform: translate(0, 0) rotate(0deg); }
        25% { transform: translate(30px, -30px) rotate(90deg); }
        50% { transform: translate(0, -60px) rotate(180deg); }
        75% { transform: translate(-30px, -30px) rotate(270deg); }
        100% { transform: translate(0, 0) rotate(360deg); }
      }

      /* æ¸¸æˆå®¹å™¨ - å…³é”®ä¿®å¤ï¼šä½¿ç”¨flexç¡®ä¿å†…å®¹å±…ä¸­ */
      #game-container {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        overflow: hidden;
        background: #000;
      }

      /* å…³é”®ï¼šæ¸¸æˆç”»å¸ƒå®¹å™¨ï¼Œä¿æŒæ¯”ä¾‹æ‹‰ä¼¸ */
      #game-app {
        width: 100%;
        height: 100%;
        background: #000;
        display: flex;
        justify-content: center;
        align-items: center;
        position: relative;
      }

      /* å¼ºåˆ¶Phaser/Canvasç”»å¸ƒæ‹‰ä¼¸å¹¶ä¿æŒæ¯”ä¾‹ */
      #game-app canvas {
        position: absolute !important;
        max-width: 100% !important;
        max-height: 100% !important;
        width: auto !important;
        height: auto !important;
        object-fit: contain !important;
        top: 50% !important;
        left: 50% !important;
        transform: translate(-50%, -50%) !important;
      }

      /* ä¿®å¤ï¼šå…¨å±æ—¶çš„ç‰¹æ®Šæ ·å¼ */
      :fullscreen #game-container,
      :-webkit-full-screen #game-container,
      :-moz-full-screen #game-container,
      :-ms-fullscreen #game-container {
        width: 100vw !important;
        height: 100vh !important;
        position: fixed !important;
        top: 0 !important;
        left: 0 !important;
        background: #000 !important;
      }

      :fullscreen #game-app,
      :-webkit-full-screen #game-app,
      :-moz-full-screen #game-app,
      :-ms-fullscreen #game-app {
        width: 100% !important;
        height: 100% !important;
        background: #000 !important;
      }

      /* å…³é”®ï¼šå…¨å±æ—¶å¼ºåˆ¶ç”»å¸ƒå¡«æ»¡ */
      :fullscreen #game-app canvas,
      :-webkit-full-screen #game-app canvas,
      :-moz-full-screen #game-app canvas,
      :-ms-fullscreen #game-app canvas {
        max-width: 100vw !important;
        max-height: 100vh !important;
        width: 100% !important;
        height: 100% !important;
        object-fit: cover !important;
      }

      /* æ¨ªå±æç¤º */
      #landscape-warning {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: linear-gradient(135deg, #0f0c29, #302b63, #24243e);
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 2000;
        text-align: center;
        padding: 20px;
        animation: gradientBG 10s ease infinite;
        background-size: 400% 400%;
      }

      @keyframes gradientBG {
        0% { background-position: 0% 50%; }
        50% { background-position: 100% 50%; }
        100% { background-position: 0% 50%; }
      }

      /* å…¨å±æŒ‰é’® */
      #fullscreen-button {
        position: fixed;
        top: 10px;
        right: 10px;
        z-index: 100;
        background: rgba(0, 0, 0, 0.7);
        color: white;
        border: 2px solid #00ccff;
        padding: 8px 12px;
        border-radius: 20px;
        font-size: 12px;
        cursor: pointer;
        display: none;
        backdrop-filter: blur(10px);
        transition: all 0.3s ease;
        font-weight: bold;
        letter-spacing: 1px;
        text-transform: uppercase;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.3);
      }

      #fullscreen-button:hover {
        background: rgba(0, 204, 255, 0.3);
        border-color: #ff0080;
        transform: scale(1.1);
      }

      #fullscreen-button.fullscreen-active {
        background: rgba(255, 0, 128, 0.3);
        border-color: #ff0080;
      }

      /* å…³é”®ä¿®å¤ï¼šå…¨å±æ—¶éšè—å…¨å±æŒ‰é’® */
      :fullscreen #fullscreen-button,
      :-webkit-full-screen #fullscreen-button,
      :-moz-full-screen #fullscreen-button,
      :-ms-fullscreen #fullscreen-button {
        display: none !important;
      }

      /* å¾®ä¿¡ä¸­éšè—å…¨å±æŒ‰é’® */
      .wechat-mode #fullscreen-button {
        display: none !important;
      }

      /* æ¸¸æˆåŠ è½½æç¤º */
      .game-loading {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        color: #00ccff;
        font-size: 18px;
        text-align: center;
        z-index: 99;
        display: none;
      }

      .loading-dots {
        display: inline-block;
        animation: dots 1.5s steps(5, end) infinite;
      }

      @keyframes dots {
        0%, 20% { content: '.'; }
        40% { content: '..'; }
        60%, 100% { content: '...'; }
      }

      /* éšè—æ»šåŠ¨æ¡ */
      ::-webkit-scrollbar {
        display: none;
      }
      
      /* iOS Safari å…¨å±ä¿®å¤ */
      @supports (-webkit-touch-callout: none) {
        html, body {
          height: -webkit-fill-available;
        }
        
        #game-container {
          height: -webkit-fill-available;
        }
      }

      /* å“åº”å¼è°ƒæ•´ */
      @media (max-width: 480px) {
        #wechat-warning {
          padding: 30px 20px;
        }
        
        .game-title {
          font-size: 36px;
        }
        
        .game-subtitle {
          font-size: 14px;
        }
        
        .warning-card,
        .steps-container {
          padding: 20px;
        }
        
        .step-item {
          gap: 16px;
          margin-bottom: 20px;
        }
        
        .step-number {
          width: 40px;
          height: 40px;
          font-size: 18px;
        }
        
        .step-text {
          font-size: 15px;
        }
        
        .warning-button {
          padding: 18px;
          font-size: 16px;
        }
      }

      @media (max-height: 700px) {
        .content-container {
          margin-top: 20px;
        }
        
        .warning-card,
        .steps-container {
          margin-bottom: 20px;
          padding: 16px;
        }
        
        .step-item {
          margin-bottom: 16px;
        }
      }
    </style>
  </head>

  <body>
    <!-- æ¨ªå±æç¤º -->
    <div id="landscape-warning">
      <div class="phone-icon">
        <div class="phone-body">
          <div class="phone-screen">
            <div class="music-bar" style="--i: 0;"></div>
            <div class="music-bar" style="--i: 1;"></div>
            <div class="music-bar" style="--i: 2;"></div>
            <div class="music-bar" style="--i: 3;"></div>
            <div class="music-bar" style="--i: 4;"></div>
            <div class="music-bar" style="--i: 5;"></div>
          </div>
        </div>
      </div>
      <div class="landscape-text">ğŸµ ç¿»è½¬è®¾å¤‡ï¼ŒèŠ‚å¥åŠ å€ï¼</div>
      <div class="landscape-subtext">æ¨ªå±æ¨¡å¼å¯è·å¾—æœ€ä½³æ¸¸æˆä½“éªŒ<br>è®©éŸ³ç¬¦åœ¨æ›´å®½çš„èˆå°ä¸Šé£èˆ</div>
      <button id="continue-portrait-button" class="continue-button">
        æˆ‘çŸ¥é“ï¼Œä½†æˆ‘å°±æƒ³ç«–ç€ç©
      </button>
    </div>
    
    <!-- å¾®ä¿¡æµè§ˆå™¨æç¤º - iOS/MZé£æ ¼é‡æ–°è®¾è®¡ -->
    <div id="wechat-warning">
      <!-- åŠ¨æ€èƒŒæ™¯å…ƒç´  -->
      <div class="background-elements">
        <div class="element"></div>
        <div class="element"></div>
        <div class="element"></div>
      </div>
      
      <!-- é¡¶éƒ¨è£…é¥° -->
      <div class="top-decoration">
        <div class="dynamic-line"></div>
        <div class="floating-dots">
          <div class="dot" style="animation-delay: 0s"></div>
          <div class="dot" style="animation-delay: 0.5s"></div>
          <div class="dot" style="animation-delay: 1s"></div>
          <div class="dot" style="animation-delay: 1.5s"></div>
          <div class="dot" style="animation-delay: 2s"></div>
        </div>
      </div>
      
      <!-- ä¸»è¦å†…å®¹ -->
      <div class="content-container">
        <div class="game-title">HALIBO BEATS</div>
        <div class="game-subtitle">IMMERSIVE RHYTHM GAME</div>
        
        <!-- è­¦å‘Šå¡ç‰‡ -->
        <div class="warning-card">
          <div class="warning-title">
            <span class="warning-icon">âš ï¸</span>
            <span>å¾®ä¿¡å†…æ¸¸æˆä½“éªŒå—é™</span>
          </div>
          <div class="warning-message">
            å¾®ä¿¡æµè§ˆå™¨æ— æ³•æä¾›å®Œæ•´çš„æ¸¸æˆåŠŸèƒ½ï¼Œå»ºè®®åœ¨ç³»ç»Ÿæµè§ˆå™¨ä¸­æ‰“å¼€ä»¥è·å¾—æœ€ä½³ä½“éªŒ
          </div>
        </div>
        
        <!-- æ­¥éª¤å¼•å¯¼ -->
        <div class="steps-container">
          <div class="steps-title">è·å–å®Œæ•´æ¸¸æˆä½“éªŒåªéœ€3æ­¥</div>
          
          <div class="step-item">
            <div class="step-number">1</div>
            <div class="step-text">
              ç‚¹å‡»å³ä¸Šè§’ <span class="step-highlight">"Â·Â·Â·"</span> æŒ‰é’®
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">2</div>
            <div class="step-text">
              é€‰æ‹© <span class="step-highlight">"åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€"</span>
            </div>
          </div>
          
          <div class="step-item">
            <div class="step-number">3</div>
            <div class="step-text">
              ç‚¹å‡» <span class="step-highlight">"â›¶ å…¨å±"</span> æŒ‰é’®å¼€å§‹æ¸¸æˆ
            </div>
          </div>
        </div>
      </div>
      
      <!-- æŒ‰é’®åŒºåŸŸ -->
      <div class="button-container">
        <button id="continue-wechat-button" class="warning-button">
          <span class="button-icon">ğŸ®</span>
          <span>ä»è¦åœ¨å¾®ä¿¡å†…æ¸¸ç©ï¼ˆä½“éªŒå—é™ï¼‰</span>
        </button>
      </div>
    </div>
    
    <!-- æ¸¸æˆå®¹å™¨ -->
    <div id="game-container">
      <button id="fullscreen-button">â›¶ å…¨å±</button>
      <div id="game-app"></div>
    </div>
    
    <!-- æ¸¸æˆåŠ è½½æç¤º -->
    <div class="game-loading" id="game-loading">
      <div>åŠ è½½èŠ‚å¥ä¸­<span class="loading-dots"></span></div>
    </div>

    <script src="./bundle.js"></script>
    
    <script>
      // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
      document.addEventListener('DOMContentLoaded', function() {
        // è·å–DOMå…ƒç´ 
        const landscapeWarning = document.getElementById('landscape-warning');
        const wechatWarning = document.getElementById('wechat-warning');
        const gameContainer = document.getElementById('game-container');
        const continuePortraitButton = document.getElementById('continue-portrait-button');
        const continueWechatButton = document.getElementById('continue-wechat-button');
        const fullscreenButton = document.getElementById('fullscreen-button');
        const gameApp = document.getElementById('game-app');
        const gameLoading = document.getElementById('game-loading');
        
        // æ£€æµ‹æ˜¯å¦åœ¨å¾®ä¿¡æµè§ˆå™¨ä¸­
        function isWechatBrowser() {
          const ua = navigator.userAgent.toLowerCase();
          return ua.indexOf('micromessenger') !== -1;
        }
        
        // å¾®ä¿¡æµè§ˆå™¨ç‰¹æ®Šå¤„ç†
        const isWechat = isWechatBrowser();
        let userConfirmedWechat = false; // ç”¨æˆ·æ˜¯å¦ç¡®è®¤åœ¨å¾®ä¿¡ä¸­ç©
        
        if (isWechat) {
          console.log('æ£€æµ‹åˆ°å¾®ä¿¡æµè§ˆå™¨ï¼Œå¯ç”¨ç‰¹æ®Šå¤„ç†æ¨¡å¼');
          document.body.classList.add('wechat-mode');
          
          // å¾®ä¿¡ä¸­ï¼šç«‹å³æ˜¾ç¤ºå¾®ä¿¡æç¤ºï¼Œä¸æ˜¾ç¤ºæ¨ªå±æç¤º
          setTimeout(() => {
            wechatWarning.style.display = 'flex';
            landscapeWarning.style.display = 'none';
            
            // å¾®ä¿¡ä¸­è‡ªåŠ¨éšè—å…¨å±æŒ‰é’®
            fullscreenButton.style.display = 'none';
          }, 300);
        } else {
          // éå¾®ä¿¡æµè§ˆå™¨ï¼šæ˜¾ç¤ºæ¨ªå±æç¤ºï¼ˆå¦‚æœéœ€è¦ï¼‰
          checkOrientation();
        }
        
        // æ£€æµ‹æ˜¯å¦æ¨ªå±
        function isLandscape() {
          return window.innerWidth > window.innerHeight;
        }
        
        // æ£€æŸ¥æ¨ªå±çŠ¶æ€å¹¶æ›´æ–°UI
        function checkOrientation() {
          if (isWechat && userConfirmedWechat) {
            // å¾®ä¿¡ä¸­ä¸”ç”¨æˆ·å·²ç»ç¡®è®¤ï¼šä¸æ˜¾ç¤ºä»»ä½•æç¤ºï¼Œç›´æ¥æ¸¸æˆ
            landscapeWarning.style.display = 'none';
            wechatWarning.style.display = 'none';
            fullscreenButton.style.display = 'none';
            return;
          }
          
          if (isLandscape()) {
            // æ¨ªå±æ¨¡å¼ - éšè—æç¤ºï¼Œæ˜¾ç¤ºå…¨å±æŒ‰é’®ï¼ˆéå¾®ä¿¡ï¼‰
            landscapeWarning.style.display = 'none';
            wechatWarning.style.display = 'none';
            
            if (!isWechat) {
              fullscreenButton.style.display = 'block';
            }
          } else {
            // ç«–å±æ¨¡å¼
            if (isWechat) {
              // å¾®ä¿¡ç«–å±ï¼šæ˜¾ç¤ºå¾®ä¿¡æç¤ºï¼ˆå¦‚æœç”¨æˆ·è¿˜æ²¡ç¡®è®¤ï¼‰
              if (!userConfirmedWechat) {
                wechatWarning.style.display = 'flex';
              }
              landscapeWarning.style.display = 'none';
              fullscreenButton.style.display = 'none';
            } else {
              // éå¾®ä¿¡ç«–å±ï¼šæ˜¾ç¤ºæ¨ªå±æç¤º
              landscapeWarning.style.display = 'flex';
              wechatWarning.style.display = 'none';
              fullscreenButton.style.display = 'none';
            }
          }
        }
        
        // è°ƒæ•´æ¸¸æˆç”»å¸ƒå°ºå¯¸
        function adjustGameCanvas() {
          setTimeout(() => {
            const canvas = gameApp.querySelector('canvas');
            if (canvas) {
              console.log('æ‰¾åˆ°æ¸¸æˆç”»å¸ƒï¼Œè°ƒæ•´å°ºå¯¸');
              
              // è·å–å®¹å™¨å°ºå¯¸
              const containerWidth = gameContainer.clientWidth;
              const containerHeight = gameContainer.clientHeight;
              
              // è·å–ç”»å¸ƒåŸå§‹å°ºå¯¸
              const originalWidth = canvas.width || 1280;
              const originalHeight = canvas.height || 720;
              
              // è®¡ç®—ç¼©æ”¾æ¯”ä¾‹
              const scaleX = containerWidth / originalWidth;
              const scaleY = containerHeight / originalHeight;
              const scale = Math.max(scaleX, scaleY);
              
              // è®¡ç®—æ–°å°ºå¯¸ï¼ˆä¿æŒæ¯”ä¾‹ï¼‰
              const newWidth = Math.floor(originalWidth * scale);
              const newHeight = Math.floor(originalHeight * scale);
              
              // è®¾ç½®ç”»å¸ƒæ˜¾ç¤ºå°ºå¯¸
              canvas.style.width = newWidth + 'px';
              canvas.style.height = newHeight + 'px';
              canvas.style.left = '50%';
              canvas.style.top = '50%';
              canvas.style.transform = 'translate(-50%, -50%)';
              canvas.style.position = 'absolute';
              
              console.log(`ç”»å¸ƒè°ƒæ•´: ${originalWidth}x${originalHeight} -> ${newWidth}x${newHeight}, ç¼©æ”¾: ${scale}`);
            } else {
              console.log('æœªæ‰¾åˆ°æ¸¸æˆç”»å¸ƒï¼Œ1ç§’åé‡è¯•');
              setTimeout(adjustGameCanvas, 1000);
            }
          }, 1000);
        }
        
        // å…¨å±åˆ‡æ¢å‡½æ•°
        function toggleFullscreen() {
          if (!document.fullscreenElement && !document.webkitFullscreenElement && !document.msFullscreenElement) {
            // è¿›å…¥å…¨å±
            const element = document.documentElement;
            
            // å¾®ä¿¡ä¸­ä¸æ‰§è¡Œå…¨å±
            if (isWechat) {
              // å¾®ä¿¡ä¸­ç‚¹å‡»å…¨å±æŒ‰é’®ï¼Œæç¤ºç”¨æˆ·ç”¨æµè§ˆå™¨æ‰“å¼€
              wechatWarning.style.display = 'flex';
              return;
            }
            
            // æ·»åŠ è§†è§‰åé¦ˆ
            fullscreenButton.classList.add('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ é€€å‡º';
            
            // æ˜¾ç¤ºåŠ è½½æç¤º
            gameLoading.style.display = 'block';
            
            // æ‰§è¡Œå…¨å±
            const requestFullscreen = element.requestFullscreen || 
                                     element.webkitRequestFullscreen || 
                                     element.msRequestFullscreen;
            
            if (requestFullscreen) {
              requestFullscreen.call(element).then(() => {
                console.log('è¿›å…¥å…¨å±æˆåŠŸ');
                
                setTimeout(() => {
                  adjustGameCanvas();
                  gameLoading.style.display = 'none';
                }, 500);
              }).catch(err => {
                console.log('å…¨å±è¯·æ±‚å¤±è´¥:', err);
                gameLoading.style.display = 'none';
                fullscreenButton.classList.remove('fullscreen-active');
                fullscreenButton.innerHTML = 'â›¶ å…¨å±';
              });
            }
          } else {
            // é€€å‡ºå…¨å±
            fullscreenButton.classList.remove('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ å…¨å±';
            
            const exitFullscreen = document.exitFullscreen || 
                                   document.webkitExitFullscreen || 
                                   document.msExitFullscreen;
            
            if (exitFullscreen) {
              exitFullscreen.call(document).then(() => {
                setTimeout(adjustGameCanvas, 300);
                checkOrientation();
              });
            }
          }
        }
        
        // äº‹ä»¶ç›‘å¬
        continuePortraitButton.addEventListener('click', function() {
          landscapeWarning.style.display = 'none';
          
          // è°ƒæ•´ç”»å¸ƒå°ºå¯¸
          setTimeout(adjustGameCanvas, 500);
        });
        
        continueWechatButton.addEventListener('click', function() {
          userConfirmedWechat = true;
          wechatWarning.style.display = 'none';
          
          // è§¦å‘ä¸€æ¬¡ç‚¹å‡»ä»¥æ¿€æ´»éŸ³é¢‘
          setTimeout(() => {
            const clickEvent = new MouseEvent('click', {
              view: window,
              bubbles: true,
              cancelable: true
            });
            gameApp.dispatchEvent(clickEvent);
          }, 100);
          
          // è°ƒæ•´ç”»å¸ƒå°ºå¯¸
          setTimeout(adjustGameCanvas, 500);
          
          console.log('å¾®ä¿¡ç”¨æˆ·ç¡®è®¤å¼€å§‹æ¸¸æˆï¼ˆå—é™æ¨¡å¼ï¼‰');
        });
        
        fullscreenButton.addEventListener('click', toggleFullscreen);
        
        // ç›‘å¬å…¨å±çŠ¶æ€å˜åŒ–
        document.addEventListener('fullscreenchange', function() {
          if (document.fullscreenElement) {
            fullscreenButton.classList.add('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ é€€å‡º';
            fullscreenButton.style.display = 'none';
            
            setTimeout(() => {
              adjustGameCanvas();
            }, 100);
          } else {
            fullscreenButton.classList.remove('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ å…¨å±';
            
            setTimeout(() => {
              if (isLandscape() && !isWechat) {
                fullscreenButton.style.display = 'block';
              }
            }, 100);
          }
        });
        
        document.addEventListener('webkitfullscreenchange', function() {
          if (document.webkitFullscreenElement) {
            fullscreenButton.classList.add('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ é€€å‡º';
            fullscreenButton.style.display = 'none';
          } else {
            fullscreenButton.classList.remove('fullscreen-active');
            fullscreenButton.innerHTML = 'â›¶ å…¨å±';
            
            setTimeout(() => {
              if (isLandscape() && !isWechat) {
                fullscreenButton.style.display = 'block';
              }
            }, 100);
          }
        });
        
        // ç›‘å¬æ¨ªç«–å±å˜åŒ–ï¼ˆå¾®ä¿¡ä¸­å¯èƒ½ä¸è§¦å‘ï¼‰
        window.addEventListener('resize', function() {
          checkOrientation();
          setTimeout(adjustGameCanvas, 300);
        });
        
        // éå¾®ä¿¡æµè§ˆå™¨ç›‘å¬orientationchange
        if (!isWechat) {
          window.addEventListener('orientationchange', function() {
            setTimeout(() => {
              checkOrientation();
              adjustGameCanvas();
            }, 100);
          });
        }
        
        // é˜²æ­¢è§¦æ‘¸é»˜è®¤è¡Œä¸º
        document.addEventListener('touchstart', function(e) {
          if (e.touches.length > 1) {
            e.preventDefault();
          }
        }, { passive: false });
        
        // é˜²æ­¢åŒå‡»ç¼©æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(e) {
          const now = Date.now();
          if (now - lastTouchEnd <= 300) {
            e.preventDefault();
          }
          lastTouchEnd = now;
        }, false);
        
        // åˆå§‹è°ƒæ•´ç”»å¸ƒå°ºå¯¸
        setTimeout(adjustGameCanvas, 2000);
        
        // æ³¨å†ŒService Workerï¼ˆéå¾®ä¿¡ï¼‰
        if ('serviceWorker' in navigator && !isWechat) {
          window.addEventListener('load', () => {
            navigator.serviceWorker.register('./service-worker.js').catch(error => {
              console.log('Service Worker æ³¨å†Œå¤±è´¥:', error);
            });
          });
        }
        
        // æä¾›å…¨å±€å‡½æ•°ä¾›bundle.jsè°ƒç”¨
        window.toggleFullscreen = toggleFullscreen;
        window.adjustGameCanvas = adjustGameCanvas;
      });
    </script>
  </body>
</html>